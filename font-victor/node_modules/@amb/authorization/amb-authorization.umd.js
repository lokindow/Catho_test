!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@amb/core"),require("rxjs/rx")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@amb/core","rxjs/rx"],t):t(e["amb-authorization"]={},e.core,e.core$1,e.rx)}(this,function(e,t,r,i){"use strict";var o,n=function(){function e(e,t,r,i){var o=this;this._elem=e,this.templateRef=r,this.viewContainer=i,this.hasView=!1,this._authorizationService=t,this._authorizationService.observable.subscribe(function(e){o.applyPermission()})}return e.prototype.ngOnInit=function(){this.applyPermission()},e.prototype.applyPermission=function(){var e=this._authorizationService.hasOneDefined(this.roles);!e&&this.hasView?(this.viewContainer.clear(),this.hasView=!1):e&&!this.hasView&&(this.viewContainer.createEmbeddedView(this.templateRef),this.hasView=!0)},Object.defineProperty(e.prototype,"ambAllowedRoles",{set:function(e){this.roles=e},enumerable:!0,configurable:!0}),e.decorators=[{type:t.Directive,args:[{selector:"[ambAllowedRoles]"}]}],e.ctorParameters=function(){return[{type:t.ElementRef},{type:r.AMBAuthorization},{type:t.TemplateRef},{type:t.ViewContainerRef}]},e.propDecorators={ambAllowedRoles:[{type:t.Input}]},e}(),s=function(){function e(e,t,r,i){var o=this;this._elem=e,this.templateRef=r,this.viewContainer=i,this.hasView=!1,this._authorizationService=t,this._authorizationService.observable.subscribe(function(e){o.applyPermission()})}return e.prototype.ngOnInit=function(){this.applyPermission()},e.prototype.applyPermission=function(){var e=this._authorizationService.hasOneDefined(this.roles);e&&this.hasView?(this.viewContainer.clear(),this.hasView=!1):e||this.hasView||(this.viewContainer.createEmbeddedView(this.templateRef),this.hasView=!0)},Object.defineProperty(e.prototype,"ambDeniedRoles",{set:function(e){this.roles=e},enumerable:!0,configurable:!0}),e.decorators=[{type:t.Directive,args:[{selector:"[ambDeniedRoles]"}]}],e.ctorParameters=function(){return[{type:t.ElementRef},{type:r.AMBAuthorization},{type:t.TemplateRef},{type:t.ViewContainerRef}]},e.propDecorators={ambDeniedRoles:[{type:t.Input}]},e}(),a=function(){function e(){this._subject=new i.Subject,this._observable=this._subject.asObservable(),this._logger=r.AMBServiceContainer.get(r.AMBServiceType.Logger.ConsoleLogger)}return e.prototype.hasDefined=function(e){return"string"==typeof e&&void 0!==this._ambUser&&this._ambUser.roles.indexOf(e.toUpperCase())>-1},e.prototype.hasOneDefined=function(e){var t=this;if(!Array.isArray(e))throw"roles parameter is not array.";return void 0!==this._ambUser&&void 0!==this._ambUser.roles&&e.some(function(e){if("string"==typeof e)return t._ambUser.roles.indexOf(e.toUpperCase())>-1})},e.prototype.emitChanges=function(e,t){this._ambUser=e,void 0!==this._ambUser&&this._logger.log('Emitindo alteações "'+t+'" para o usuário '+this._ambUser.username+" no serviço de autorização",2),this._subject.next(t)},Object.defineProperty(e.prototype,"observable",{get:function(){return this._observable},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ambUser",{set:function(e){this._ambUser=e,void 0!==this._ambUser&&this._logger.log("Setando o usuário "+this._ambUser+" no serviço de autorização",2)},enumerable:!0,configurable:!0}),e.decorators=[{type:t.Injectable}],e.ctorParameters=function(){return[]},e}(),u=(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),c=function(e){function r(){return e.call(this)||this}return u(r,e),r.decorators=[{type:t.Injectable}],r.ctorParameters=function(){return[]},r}(r.AMBRolesMapping),p=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[{provide:r.AMBRolesMapping,useClass:c},{provide:r.AMBAuthorization,useClass:a}]}},e.decorators=[{type:t.NgModule,args:[{declarations:[n,s],imports:[],exports:[n,s]}]}],e.ctorParameters=function(){return[]},e}();e.AMBAuthorizationModule=p,e.AMBAllowedRolesDirective=n,e.AMBDeniedRolesDirective=s,e.AMBAuthorizationService=a,Object.defineProperty(e,"__esModule",{value:!0})});